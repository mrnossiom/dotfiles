# mrnossiom's NixOS and Home Manager configuration

# Options

```nix
{
	local.fragment."name".enable = true; # bool; dictate whether to enable a fragment

	local.option = {
		onlyCached = true; # bool; dictate if you are to compile pkgs or use cache
	};
}
```

# Bootstrap lightweight HM config

```
nix run nixpkgs#home-manager -- switch --flake .#lightweight
```

# Structure

- `apps`: Scripts serving dotfiles purposes
- `assets`: Media or files that don't fit in Nix files
- `home-manager`: Home Manager specific
	- `fragments`: Home Manager configuration fragments
	- `options`: Home Manager configuration flags
	- `profiles`: Base Home Manager configurations to build upon (e.g. `desktop`, `minimal`)
- `lib`: Additional custom lib and flake helpers 
- `modules`: modules that fill a missing feature of NixOS or Home Manager
- `nixos`: NixOS related config
	- `hardware/<hostname>.nix`: Device-specific settings like settings generated by `nixos-generate-config`
	- `layout/<layout>.nix`: `Disko` disk layouts used by `managedDiskLayout` (e.g `luks-btrfs`)
	- `fragments`: Opinionated NixOS configuration fragments
	- `profiles/<profile>.nix`: Base system configurations to build upon (e.g. `laptop`, `installer`)
- `overlays`: Just plain Nix overlays
- `pkgs`: Custom packages either not eligible or missing from repositories
- `secrets`: `agenix` encrypted secrets
- `templates`: Quickstart files for different languages

# Add a new device

- Rekey secrets with device root ssh key, and create a session age key.

---

Milo Moisson Â© 2023-2024
